!function(){"use strict";var e=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/ & /g,"-and-").replace(/<[^>]+>/g,"").replace(/['â€™.]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/--+/g,"-"):"";function t(t){const n=t.getAttribute("data-autocomplete"),a=t.getAttribute("data-autocomplete-name"),o=t.querySelector(".autocomplete__input"),r=t.querySelector(".autocomplete__clear"),s=t.querySelector(".autocomplete__results"),l=t.querySelector(".autocomplete__results-list"),d=t.querySelector(".autocomplete__results-none"),c=t.querySelector(".autocomplete__selected-list");let i="",u=null,m=!1,p=t.querySelector("[data-autocomplete-value]").value;p&&(p=JSON.parse(p));const b=()=>{s.classList.add("hide"),l.innerText=""},A=()=>{t.classList.remove("clearable")},v=e=>{const t=e.target.getAttribute("data-id");e.target.closest("li").remove(),o.focus();const n=p.findIndex(e=>e.id===t);n>-1&&(p.splice(n,1),p.length<=0&&c.classList.add("hide"))},g=e=>{const t=document.createElement("li");t.setAttribute("class","autocomplete__selected-item");const n=document.createElement("input");n.setAttribute("name",`${a}[]`),n.setAttribute("type","hidden"),n.setAttribute("value",e.id),t.appendChild(n);const r=document.createElement("a");r.setAttribute("class","autocomplete__selected-link"),r.setAttribute("href",e.url),r.innerText=e.title,t.appendChild(r);const s=document.createElement("button");s.setAttribute("class","autocomplete__selected-button"),s.setAttribute("data-id",e.id),s.setAttribute("type","button"),s.addEventListener("click",v),s.innerText="Remove",t.appendChild(s),c.appendChild(t),c.classList.remove("hide"),o.value="",i="",b(),A()},h=e=>{let t=e.target;"BUTTON"!==t.tagName&&(t=t.closest("button"));const n={id:t.getAttribute("data-id"),url:t.getAttribute("data-url"),title:t.innerText};p.push(n),g(n),o.focus()},E=e=>{document.querySelector("[data-selected]").removeAttribute("data-selected");const t=e.target.closest(".autocomplete__results-item");t.setAttribute("data-selected",1),u=parseInt(t.getAttribute("data-index"),10)},y=e=>{m||(m=!0,t.classList.add("loading"),fetch(`${n}${e}`).then(e=>e.json()).then(e=>{t.classList.remove("loading");let n=!1,a=0;l.innerText="",e.items.forEach(e=>{if(p.findIndex(t=>t.id===e.id)>-1)return;const t=((e,t)=>{const n=document.createElement("li");n.setAttribute("class","autocomplete__results-item"),n.setAttribute("data-index",e),0===e&&(n.setAttribute("data-selected",1),u=e);const a=document.createElement("button");return a.setAttribute("class","autocomplete__results-button"),a.setAttribute("data-id",t.id),a.setAttribute("data-url",t.url),a.setAttribute("type","button"),a.innerText=t.title,a.addEventListener("click",h),a.addEventListener("mouseover",E),n.appendChild(a),n})(a,e);l.appendChild(t),a+=1,n=!0}),s.classList.remove("hide"),n?(d.classList.add("hide"),l.classList.remove("hide"),l.firstChild.scrollIntoView({block:"nearest"})):(d.classList.remove("hide"),l.classList.add("hide")),m=!1}))},f=e=>{"Enter"===e.key&&o.value&&e.preventDefault()},L=()=>{const n=e(o.value);n?(t.classList.add("clearable"),n!==i&&(i=n,y(n))):(A(),i="",b())},w=()=>"none"!==s.style.display,_=()=>{const t=e(o.value);t&&!w()&&y(t)},S=e=>{if(!w())return;let t=document.querySelector("[data-selected]");"Enter"===e.key?t&&(e.preventDefault(),h({target:t.querySelector("button")})):"ArrowDown"===e.key?(t.removeAttribute("data-selected"),u>=l.querySelectorAll("li").length-1?u=0:u+=1,t=l.querySelector(`[data-index="${u}"]`),t.setAttribute("data-selected",1),t.scrollIntoView({block:"nearest"})):"ArrowUp"===e.key?(t.removeAttribute("data-selected"),u>0?u-=1:u=l.querySelectorAll("li").length-1,t=l.querySelector(`[data-index="${u}"]`),t.setAttribute("data-selected",1),t.scrollIntoView({block:"nearest"})):"Escape"===e.key&&(b(),e.stopPropagation())},k=()=>{o.value="",L(),o.focus()};document.addEventListener("keyup",S,{capture:!0}),o.addEventListener("keydown",f),o.addEventListener("keyup",((e,t,n)=>{let a;return(...o)=>{const r=n&&!a;clearTimeout(a),a=setTimeout(()=>{a=null,n||e(...o)},t),r&&e(...o)}})(L,250)),o.addEventListener("focus",_),r.addEventListener("click",k),p.length>0&&p.forEach(e=>{g(e)})}function n(e){return e.preventDefault(),"You have unsaved changes. Are you sure you want to leave the page?"}function a(){window.HAS_UNSAVED_CHANGES||(window.HAS_UNSAVED_CHANGES=!0,window.addEventListener("beforeunload",n,{capture:!0}),document.title=`* ${document.title}`)}const o=()=>{window.HAS_UNSAVED_CHANGES=!1,window.removeEventListener("beforeunload",n,{capture:!0}),document.title=document.title.replace(/^\* /,"")};class r{constructor(e){this.args=e}show(){document.body.classList.add("modal-open");const e=document.createElement("dialog");e.setAttribute("class","modal"),e.setAttribute("tabindex","-1");const t=document.createElement("div");t.setAttribute("class","modal__box"),e.appendChild(t);const n=document.createElement("p");n.innerText=this.args.message,t.appendChild(n);const a=document.createElement("p");a.setAttribute("class","modal__options"),t.appendChild(a),this.args.buttons.forEach(t=>{const n=document.createElement("button");n.setAttribute("class",`button ${t.class}`.trim()),n.setAttribute("type","button"),n.innerText=t.label,n.addEventListener("click",()=>{Object.hasOwn(t,"onClick")&&t.onClick(),e.close()}),a.appendChild(n)}),e.addEventListener("click",t=>{"DIALOG"===t.target.tagName&&e.close()}),document.body.appendChild(e),e.showModal(),e.focus()}}function s(e){const t=e.target,n=t.getAttribute("data-confirmable");new r({message:n,buttons:[{label:"Cancel",class:"button--secondary"},{label:t.innerText,class:t.getAttribute("class"),onClick:()=>{const e=document.querySelector(`#${t.getAttribute("form")}`);void 0!==e.getAttribute("data-ignore-unsaved")&&o(),e.submit()}}]}).show()}function l(){const e=document.getElementById("type").value;document.querySelectorAll("[data-show-for-type]").forEach(t=>{t.getAttribute("data-show-for-type").split(",").includes(e)?t.classList.remove("hide"):t.classList.add("hide")})}function d(t){const n=t.getAttribute("data-slug").split(","),a=document.querySelectorAll(n),o=()=>{t.value=(()=>{const t=[];return a.forEach(e=>{"end_release_year"===e.name&&e.value===t.at(-1)||t.push(e.value)}),e(t.join("-"))})()};Array.from(a).forEach(e=>{e.addEventListener("keyup",o)})}function c(e,t=2,n="0"){return n=n||"0",(e=e.toString()).length>=t?e:new Array(t-e.length+1).join(n)+e}function i(){const e=new Date,t=`${e.getFullYear()}-${c(e.getMonth()+1)}-${c(e.getDate())}`;document.getElementById("start_date").value=t}document.querySelectorAll("[data-autocomplete]").forEach(e=>{t(e)}),(()=>{const e=document.querySelector("[data-form]");if(e){e.querySelectorAll("input,select,textarea").forEach(e=>{e.addEventListener("keyup",a),e.addEventListener("change",a)}),e.addEventListener("submit",o)}})(),document.querySelectorAll("[data-confirmable]").forEach(e=>{e.addEventListener("click",s,!0)}),(()=>{const e=document.getElementById("nav-show"),t=e.getAttribute("aria-controls"),n=document.getElementById(t),a="function"==typeof HTMLDialogElement,o=()=>{const e=document.getElementById(`${t}-dialog`);document.body.classList.remove(`show-${t}`),a&&e.close(),e.parentNode.appendChild(n),e.remove(),n.removeEventListener("transitionend",o)},r=()=>{window.removeEventListener("resize",s),e.setAttribute("aria-expanded","false"),document.body.classList.remove(`animate-${t}`),n.addEventListener("transitionend",o)},s=()=>{window.innerWidth>=1024&&(r(),o())},l=e=>{e.preventDefault(),r(e.target)},d=e=>{"DIALOG"===e.target.tagName&&r(e.target)},c=()=>{if(window.innerWidth>=1024)return;e.setAttribute("aria-expanded","true");const o=document.createElement(a?"dialog":"div");o.setAttribute("id",`${t}-dialog`),a&&(o.addEventListener("cancel",l),o.addEventListener("click",d));const c=document.createElement("button");c.setAttribute("aria-controls",t),c.setAttribute("aria-expanded","true"),c.setAttribute("class","button--icon"),c.setAttribute("id",`${t}-close`),c.setAttribute("title","Close Menu"),c.setAttribute("type","button"),c.innerText="Close Menu",c.addEventListener("click",()=>{r(document.getElementById(`${t}-dialog`))}),o.appendChild(c),document.body.classList.add(`show-${t}`);const i=n.parentNode;n.remove(),o.appendChild(n),i.appendChild(o),a&&o.showModal(),window.addEventListener("resize",s),setTimeout(()=>{document.body.classList.add(`animate-${t}`)},10)};e.addEventListener("click",c)})(),(()=>{const e=document.getElementById("type");e&&(e.addEventListener("change",l),l())})(),document.querySelectorAll("[data-slug]").forEach(e=>{d(e)}),(()=>{const e=document.querySelector('[data-action="today"]');e&&e.addEventListener("click",i)})()}();