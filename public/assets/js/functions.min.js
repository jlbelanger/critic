function Autocomplete(e){const t=e.getAttribute("data-autocomplete"),a=e.getAttribute("data-autocomplete-name"),r=e.querySelector(".autocomplete__input"),l=e.querySelector(".autocomplete__clear"),n=e.querySelector(".autocomplete__results"),o=e.querySelector(".autocomplete__results-list"),i=e.querySelector(".autocomplete__results-none"),s=e.querySelector(".autocomplete__selected-list"),c=window.AUTOCOMPLETE_SELECTED;let u="",d=null,p=!1;const b=()=>{n.style.display="none",o.innerText=""},y=()=>{e.classList.remove("clearable")},f=e=>{const t=e.target.getAttribute("data-id");e.target.closest("li").remove(),r.focus();const a=c.findIndex((e=>e.id===t));a>-1&&(c.splice(a,1),c.length<=0&&(s.style.display="none"))},m=e=>{const t=document.createElement("li");t.setAttribute("class","autocomplete__selected-item");const l=document.createElement("input");l.setAttribute("name",`${a}[]`),l.setAttribute("type","hidden"),l.setAttribute("value",e.id),t.appendChild(l);const n=document.createElement("a");n.setAttribute("class","autocomplete__selected-link"),n.setAttribute("href",e.url),n.innerText=e.title,t.appendChild(n);const o=document.createElement("button");o.setAttribute("class","autocomplete__selected-button"),o.setAttribute("data-id",e.id),o.setAttribute("type","button"),o.addEventListener("click",f),o.innerText="Remove",t.appendChild(o),s.appendChild(t),s.style.display="",r.value="",u="",b(),y()},g=e=>{let t=e.target;"BUTTON"!==t.tagName&&(t=t.closest("button"));const a={id:t.getAttribute("data-id"),url:t.getAttribute("data-url"),title:t.innerText};c.push(a),m(a),r.focus()},A=e=>{document.querySelector("[data-selected]").removeAttribute("data-selected");const t=e.target.closest(".autocomplete__results-item");t.setAttribute("data-selected",1),d=parseInt(t.getAttribute("data-index"),10)},h=a=>{p||(p=!0,e.classList.add("loading"),fetch(`${t}${a}`).then((e=>e.json())).then((t=>{e.classList.remove("loading");let a=!1,r=0;o.innerText="",t.items.forEach((e=>{if(c.findIndex((t=>t.id===e.id))>-1)return;const t=((e,t)=>{const a=document.createElement("li");a.setAttribute("class","autocomplete__results-item"),a.setAttribute("data-index",e),0===e&&(a.setAttribute("data-selected",1),d=e);const r=document.createElement("button");return r.setAttribute("class","autocomplete__results-button"),r.setAttribute("data-id",t.id),r.setAttribute("data-url",t.url),r.setAttribute("type","button"),r.innerText=t.title,r.addEventListener("click",g),r.addEventListener("mouseover",A),a.appendChild(r),a})(r,e);o.appendChild(t),r+=1,a=!0})),n.style.display="",a?(i.style.display="none",o.style.display="",o.firstChild.scrollIntoView({block:"nearest"})):(i.style.display="",o.style.display="none"),p=!1})))},E=e=>{"Enter"===e.key&&r.value&&e.preventDefault()},v=()=>{const t=slugify(r.value);t?(e.classList.add("clearable"),t!==u&&(u=t,h(t))):(y(),u="",b())},S=()=>"none"!==n.style.display,L=()=>{const e=slugify(r.value);e&&!S()&&h(e)},w=e=>{if(!S())return;let t=document.querySelector("[data-selected]");"Enter"===e.key?t&&(e.preventDefault(),g({target:t.querySelector("button")})):"ArrowDown"===e.key?(t.removeAttribute("data-selected"),d>=o.querySelectorAll("li").length-1?d=0:d+=1,t=o.querySelector(`[data-index="${d}"]`),t.setAttribute("data-selected",1),t.scrollIntoView({block:"nearest"})):"ArrowUp"===e.key?(t.removeAttribute("data-selected"),d>0?d-=1:d=o.querySelectorAll("li").length-1,t=o.querySelector(`[data-index="${d}"]`),t.setAttribute("data-selected",1),t.scrollIntoView({block:"nearest"})):"Escape"===e.key&&(b(),e.stopPropagation())},q=()=>{r.value="",v(),r.focus()};document.addEventListener("keyup",w,{capture:!0}),r.addEventListener("keydown",E),r.addEventListener("keyup",debounce(v,250)),r.addEventListener("focus",L),l.addEventListener("click",q),c.length>0&&c.forEach((e=>{m(e)}))}function initAutocomplete(){document.querySelectorAll("[data-autocomplete]").forEach((e=>{Autocomplete(e)}))}function onBeforeUnload(e){return e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave the page?"}function addUnloadListener(){window.addEventListener("beforeunload",onBeforeUnload,{capture:!0})}function removeUnloadListener(){window.removeEventListener("beforeunload",onBeforeUnload,{capture:!0})}initAutocomplete();const $form=document.getElementById("form");if($form){$form.querySelectorAll("input,select,textarea").forEach((e=>{e.addEventListener("keyup",addUnloadListener),e.addEventListener("change",addUnloadListener)})),$form.addEventListener("submit",removeUnloadListener)}const clouds=document.querySelectorAll(".cloud");function Confirmable(e){e.addEventListener("submit",(e=>{const t=e.target.getAttribute("data-confirmable");return!!window.confirm(t)||(e.preventDefault(),!1)}),!0)}function initConfirmable(){document.querySelectorAll("[data-confirmable]").forEach((e=>{Confirmable(e)}))}function debounce(e,t,a){let r;return function(){const l=this,n=arguments,o=function(){r=null,a||e.apply(l,n)},i=a&&!r;clearTimeout(r),r=setTimeout(o,t),i&&e.apply(l,n)}}function Filterable(e){const t=e.querySelectorAll("[data-filterable-input]"),a=e.querySelectorAll("[data-filterable-item]"),r=document.querySelector("[data-filterable-num]"),l=r?parseInt(r.innerText.replace(",",""),10):a.length,n=()=>{const t=e.querySelectorAll('[data-filterable-item]:not([data-filter-hide^="("])').length;(e=>{r.innerText=e!==l&&e<l?`${e.toLocaleString()} of ${l.toLocaleString()}`:l.toLocaleString()})(t),t<=0?e.classList.add("no-results"):e.classList.remove("no-results")},o=e=>e.getAttribute("data-value")?slugify(e.getAttribute("data-value")):slugify(e.innerText),i=e=>{const t=e.target,r=t.getAttribute("data-filterable-input"),l=t.getAttribute("data-filterable-exact"),i=slugify(t.value);a.forEach((e=>{const t=e.querySelector(`[data-key="${r}"]`);!i||t&&(l?o(t)===i:o(t).indexOf(i)>-1)?((e,t)=>{const a=e.getAttribute("data-filter-hide")||"";e.setAttribute("data-filter-hide",a.replace(`(${t})`,""))})(e,r):((e,t)=>{const a=e.getAttribute("data-filter-hide")||"";a.includes(`(${t})`)||e.setAttribute("data-filter-hide",`${a}(${t})`)})(e,r)})),n()};t.forEach((e=>{e.addEventListener("keyup",debounce(i,100)),e.addEventListener("change",i),e.value&&i({target:e})}))}function initFilterable(){document.querySelectorAll("[data-filterable-list]").forEach((e=>{Filterable(e)}))}clouds.forEach((e=>{const t=e.querySelectorAll(".cloud__num");let a=0;t.forEach((e=>{const t=parseInt(e.innerText,10);t>a&&(a=t)}));t.forEach((e=>{const t=parseInt(e.innerText,10);if(t){const r=Math.log(t)/Math.log(a)*14+10;e.closest("li").style.fontSize=`${r}px`}}))})),initConfirmable(),initFilterable();const graphs=document.querySelectorAll(".graph");function Password(e){e.addEventListener("click",(t=>{const a=t.target.closest(".password-container").querySelector(".password-input");"password"===a.getAttribute("type")?(a.setAttribute("type","text"),a.setAttribute("aria-label","Hide Password"),e.innerText="Hide"):(a.setAttribute("type","password"),a.setAttribute("aria-label","Show Password"),e.innerText="Show")}))}function initPassword(){document.querySelectorAll("[data-toggle-password]").forEach((e=>{Password(e)}))}function Slugable(e){const t=e.getAttribute("data-slug").split(","),a=document.querySelectorAll(t),r=()=>{e.value=(()=>{const e=[];return a.forEach((t=>{"end_release_year"===t.name&&t.value===e.at(-1)||e.push(t.value)})),slugify(e.join("-"))})()};Array.from(a).forEach((e=>{e.addEventListener("keyup",r)}))}function initSlugable(){document.querySelectorAll("[data-slug]").forEach((e=>{Slugable(e)}))}function slugify(e){return e?e.toLowerCase().replace(/ & /g,"-and-").replace(/<[^>]+>/g,"").replace(/['â€™.]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/--+/g,"-"):""}function Sortable(e){let t=[],a=e.getAttribute("data-sortable-default-key"),r=e.getAttribute("data-sortable-default-dir")?e.getAttribute("data-sortable-default-dir"):"asc";const l=e.querySelectorAll("[data-sortable-key]"),n=e.querySelector("[data-sortable-container]"),o=e.querySelectorAll("[data-sortable-item]"),i=e=>{const l=`sortable-button--${r}`;Array.from(document.getElementsByClassName(l)).forEach((e=>{e.classList.remove(l)}));const o=e.target,i=o.getAttribute("data-sortable-key");r=i===a?"desc"===r?"asc":"desc":"asc",o.classList.add(`sortable-button--${r}`),(e=>{t=t.sort(((t,a)=>""===t[e]&&""!==a[e]?1:""!==t[e]&&""===a[e]?-1:t[e]===a[e]?0:"desc"===r?t[e]<a[e]?1:-1:t[e]<a[e]?-1:1))})(i),n.innerText="",t.forEach((e=>{n.appendChild(e.row)})),a=i};(()=>{o.forEach((e=>{const a={row:e};e.querySelectorAll("td").forEach((e=>{const t=e.getAttribute("data-key"),r=e.getAttribute("data-sortable-value")||e.getAttribute("data-value")||e.innerText.trim();a[t]=r})),t.push(a)})),l.forEach((e=>{e.addEventListener("click",i)}));e.querySelector(`[data-sortable-key="${a}"]`).classList.add(`sortable-button--${r}`)})()}function initSortable(){document.querySelectorAll("[data-sortable-list]").forEach((e=>{Sortable(e)}))}function showHideByType(){const e=document.getElementById("type").value;document.querySelectorAll("[data-show-for-type]").forEach((t=>{t.getAttribute("data-show-for-type").split(",").includes(e)?t.style.display="":t.style.display="none"}))}function initShowForType(){const e=document.getElementById("type");e&&(e.addEventListener("change",showHideByType),showHideByType())}graphs.forEach((e=>{const t=e.querySelectorAll(".graph__bar"),a=t[0].clientHeight;let r=0;t.forEach((e=>{const t=parseInt(e.innerText,10);e.innerText&&t>r&&(r=t)})),t.forEach((e=>{if(e.innerText){const t=parseInt(e.innerText,10);e.style.height=t/r*a+"px"}else e.style.height=0}))})),initPassword(),initSlugable(),initSortable(),initShowForType();