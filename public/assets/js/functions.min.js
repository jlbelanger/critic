function Autocomplete(e){const t=e.getAttribute("data-autocomplete"),a=e.getAttribute("data-autocomplete-name"),n=e.querySelector(".autocomplete__input"),l=e.querySelector(".autocomplete__clear"),r=e.querySelector(".autocomplete__results"),o=e.querySelector(".autocomplete__results-list"),i=e.querySelector(".autocomplete__results-none"),s=e.querySelector(".autocomplete__selected-list"),c=window.AUTOCOMPLETE_SELECTED;let u="",d=null,b=!1;const p=()=>{r.style.display="none",o.innerText=""},y=()=>{e.classList.remove("clearable")},f=e=>{const t=e.target.getAttribute("data-id");e.target.closest("li").remove(),n.focus();const a=c.findIndex((e=>e.id===t));a>-1&&(c.splice(a,1),c.length<=0&&(s.style.display="none"))},g=e=>{const t=document.createElement("li");t.setAttribute("class","autocomplete__selected-item");const l=document.createElement("input");l.setAttribute("name",`${a}[]`),l.setAttribute("type","hidden"),l.setAttribute("value",e.id),t.appendChild(l);const r=document.createElement("a");r.setAttribute("class","autocomplete__selected-link"),r.setAttribute("href",e.url),r.innerText=e.title,t.appendChild(r);const o=document.createElement("button");o.setAttribute("class","autocomplete__selected-button"),o.setAttribute("data-id",e.id),o.setAttribute("type","button"),o.addEventListener("click",f),o.innerText="Remove",t.appendChild(o),s.appendChild(t),s.style.display="",n.value="",u="",p(),y()},m=e=>{let t=e.target;"BUTTON"!==t.tagName&&(t=t.closest("button"));const a={id:t.getAttribute("data-id"),url:t.getAttribute("data-url"),title:t.innerText};c.push(a),g(a),n.focus()},h=e=>{document.querySelector("[data-selected]").removeAttribute("data-selected");const t=e.target.closest(".autocomplete__results-item");t.setAttribute("data-selected",1),d=parseInt(t.getAttribute("data-index"),10)},A=a=>{b||(b=!0,e.classList.add("loading"),fetch(`${t}${a}`).then((e=>e.json())).then((t=>{e.classList.remove("loading");let a=!1,n=0;o.innerText="",t.items.forEach((e=>{if(c.findIndex((t=>t.id===e.id))>-1)return;const t=((e,t)=>{const a=document.createElement("li");a.setAttribute("class","autocomplete__results-item"),a.setAttribute("data-index",e),0===e&&(a.setAttribute("data-selected",1),d=e);const n=document.createElement("button");return n.setAttribute("class","autocomplete__results-button"),n.setAttribute("data-id",t.id),n.setAttribute("data-url",t.url),n.setAttribute("type","button"),n.innerText=t.title,n.addEventListener("click",m),n.addEventListener("mouseover",h),a.appendChild(n),a})(n,e);o.appendChild(t),n+=1,a=!0})),r.style.display="",a?(i.style.display="none",o.style.display="",o.firstChild.scrollIntoView({block:"nearest"})):(i.style.display="",o.style.display="none"),b=!1})))},E=e=>{"Enter"===e.key&&n.value&&e.preventDefault()},v=()=>{const t=slugify(n.value);t?(e.classList.add("clearable"),t!==u&&(u=t,A(t))):(y(),u="",p())},S=()=>"none"!==r.style.display,L=()=>{const e=slugify(n.value);e&&!S()&&A(e)},w=e=>{if(!S())return;let t=document.querySelector("[data-selected]");"Enter"===e.key?t&&(e.preventDefault(),m({target:t.querySelector("button")})):"ArrowDown"===e.key?(t.removeAttribute("data-selected"),d>=o.querySelectorAll("li").length-1?d=0:d+=1,t=o.querySelector(`[data-index="${d}"]`),t.setAttribute("data-selected",1),t.scrollIntoView({block:"nearest"})):"ArrowUp"===e.key?(t.removeAttribute("data-selected"),d>0?d-=1:d=o.querySelectorAll("li").length-1,t=o.querySelector(`[data-index="${d}"]`),t.setAttribute("data-selected",1),t.scrollIntoView({block:"nearest"})):"Escape"===e.key&&(p(),e.stopPropagation())},q=()=>{n.value="",v(),n.focus()};document.addEventListener("keyup",w,{capture:!0}),n.addEventListener("keydown",E),n.addEventListener("keyup",debounce(v,250)),n.addEventListener("focus",L),l.addEventListener("click",q),c.length>0&&c.forEach((e=>{g(e)}))}function initAutocomplete(){document.querySelectorAll("[data-autocomplete]").forEach((e=>{Autocomplete(e)}))}function onBeforeUnload(e){return e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave the page?"}function addUnloadListener(){window.addEventListener("beforeunload",onBeforeUnload,{capture:!0})}function removeUnloadListener(){window.removeEventListener("beforeunload",onBeforeUnload,{capture:!0})}function initBeforeUnload(){const e=document.getElementById("form");if(e){e.querySelectorAll("input,select,textarea").forEach((e=>{e.addEventListener("keyup",addUnloadListener),e.addEventListener("change",addUnloadListener)})),e.addEventListener("submit",removeUnloadListener)}}function Cloudable(e){const t=e.querySelectorAll(".cloud__num");let a=0;t.forEach((e=>{const t=parseInt(e.innerText,10);t>a&&(a=t)}));t.forEach((e=>{const t=parseInt(e.innerText,10);if(t){const n=Math.log(t)/Math.log(a)*14+10;e.closest("li").style.fontSize=`${n}px`}}))}function initClouds(){document.querySelectorAll(".cloud").forEach((e=>{Cloudable(e)}))}function Confirmable(e){const t=e=>{const t=e.target.getAttribute("data-confirmable");return!!window.confirm(t)||(e.preventDefault(),!1)};e.addEventListener("submit",t,!0)}function initConfirmable(){document.querySelectorAll("[data-confirmable]").forEach((e=>{Confirmable(e)}))}function debounce(e,t,a){let n;return function(){const l=this,r=arguments,o=function(){n=null,a||e.apply(l,r)},i=a&&!n;clearTimeout(n),n=setTimeout(o,t),i&&e.apply(l,r)}}function Filterable(e){const t=e.querySelectorAll("[data-filterable-input]"),a=e.querySelectorAll("[data-filterable-item]"),n=document.querySelector("[data-filterable-num]"),l=n?parseInt(n.innerText.replace(",",""),10):a.length,r=()=>{const t=e.querySelectorAll('[data-filterable-item]:not([data-filter-hide^="("])').length;(e=>{n.innerText=e!==l&&e<l?`${e.toLocaleString()} of ${l.toLocaleString()}`:l.toLocaleString()})(t),t<=0?e.classList.add("no-results"):e.classList.remove("no-results")},o=e=>e.getAttribute("data-value")?slugify(e.getAttribute("data-value")):slugify(e.innerText),i=e=>{const t=e.target,n=t.getAttribute("data-filterable-input"),l=t.getAttribute("data-filterable-exact"),i=slugify(t.value);a.forEach((e=>{const t=e.querySelector(`[data-key="${n}"]`);!i||t&&(l?o(t)===i:o(t).indexOf(i)>-1)?((e,t)=>{const a=e.getAttribute("data-filter-hide")||"";e.setAttribute("data-filter-hide",a.replace(`(${t})`,""))})(e,n):((e,t)=>{const a=e.getAttribute("data-filter-hide")||"";a.includes(`(${t})`)||e.setAttribute("data-filter-hide",`${a}(${t})`)})(e,n)})),r()};t.forEach((e=>{e.addEventListener("keyup",debounce(i,100)),e.addEventListener("change",i),e.value&&i({target:e})}))}function initFilterable(){document.querySelectorAll("[data-filterable-list]").forEach((e=>{Filterable(e)}))}function Graphable(e){const t=e.querySelectorAll(".graph__bar"),a=t[0].clientHeight;let n=0;t.forEach((e=>{const t=parseInt(e.innerText,10);e.innerText&&t>n&&(n=t)})),t.forEach((e=>{if(e.innerText){const t=parseInt(e.innerText,10);e.style.height=t/n*a+"px"}else e.style.height=0}))}function initGraphs(){document.querySelectorAll(".graph").forEach((e=>{Graphable(e)}))}function Menu(){const e=document.body,t=document.getElementById("menu-button"),a=()=>{e.classList.remove("open-menu")},n=()=>{e.classList.contains("open-menu")?a():e.classList.add("open-menu")},l=e=>{"Escape"===e.key&&a()};this.init=()=>{t&&(t.addEventListener("click",n),document.addEventListener("keyup",l))}}function Passwordable(e){const t=t=>{const a=t.target.closest(".password-container").querySelector(".password-input");"password"===a.getAttribute("type")?(a.setAttribute("type","text"),a.setAttribute("aria-label","Hide Password"),e.innerText="Hide"):(a.setAttribute("type","password"),a.setAttribute("aria-label","Show Password"),e.innerText="Show")};e.addEventListener("click",t)}function initPasswordable(){document.querySelectorAll("[data-toggle-password]").forEach((e=>{Passwordable(e)}))}function Slugable(e){const t=e.getAttribute("data-slug").split(","),a=document.querySelectorAll(t),n=()=>{e.value=(()=>{const e=[];return a.forEach((t=>{"end_release_year"===t.name&&t.value===e.at(-1)||e.push(t.value)})),slugify(e.join("-"))})()};Array.from(a).forEach((e=>{e.addEventListener("keyup",n)}))}function initSlugable(){document.querySelectorAll("[data-slug]").forEach((e=>{Slugable(e)}))}function slugify(e){return e?e.toLowerCase().replace(/ & /g,"-and-").replace(/<[^>]+>/g,"").replace(/['â€™.]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/--+/g,"-"):""}function Sortable(e){let t=[],a=e.getAttribute("data-sortable-default-key"),n=e.getAttribute("data-sortable-default-dir")?e.getAttribute("data-sortable-default-dir"):"asc";const l=e.querySelectorAll("[data-sortable-key]"),r=e.querySelector("[data-sortable-container]"),o=e.querySelectorAll("[data-sortable-item]"),i=e=>{const l=`sortable-button--${n}`;Array.from(document.getElementsByClassName(l)).forEach((e=>{e.classList.remove(l)}));const o=e.target,i=o.getAttribute("data-sortable-key");n=i===a?"desc"===n?"asc":"desc":"asc",o.classList.add(`sortable-button--${n}`),(e=>{t=t.sort(((t,a)=>""===t[e]&&""!==a[e]?1:""!==t[e]&&""===a[e]?-1:t[e]===a[e]?0:"desc"===n?t[e]<a[e]?1:-1:t[e]<a[e]?-1:1))})(i),r.innerText="",t.forEach((e=>{r.appendChild(e.row)})),a=i};(()=>{o.forEach((e=>{const a={row:e};e.querySelectorAll("td").forEach((e=>{const t=e.getAttribute("data-key"),n=e.getAttribute("data-sortable-value")||e.getAttribute("data-value")||e.innerText.trim();a[t]=n})),t.push(a)})),l.forEach((e=>{e.addEventListener("click",i)}));e.querySelector(`[data-sortable-key="${a}"]`).classList.add(`sortable-button--${n}`)})()}function initSortable(){document.querySelectorAll("[data-sortable-list]").forEach((e=>{Sortable(e)}))}function Toggleable(e){const t=()=>{const t=e.getAttribute("data-toggle"),a=document.querySelector(t);a.classList.toggle("toggle-hidden"),a.classList.toggle("toggle-visible"),a.classList.contains("toggle-hidden")?e.innerText=e.getAttribute("data-show-label"):e.innerText=e.getAttribute("data-hide-label")};e.addEventListener("click",t)}function initToggleable(){document.querySelectorAll("[data-toggle]").forEach((e=>{Toggleable(e)}))}function showHideByType(){const e=document.getElementById("type").value;document.querySelectorAll("[data-show-for-type]").forEach((t=>{t.getAttribute("data-show-for-type").split(",").includes(e)?t.style.display="":t.style.display="none"}))}function initShowForType(){const e=document.getElementById("type");e&&(e.addEventListener("change",showHideByType),showHideByType())}initAutocomplete(),initBeforeUnload(),initClouds(),initConfirmable(),initFilterable(),initGraphs(),(new Menu).init(),initPasswordable(),initSlugable(),initSortable(),initToggleable(),initShowForType();